
= java 语法

== SafePoint 安全点

程序执行时并非在所有地方都能停顿下来开始 GC，只有在到达安全点时才能暂停。

安全点的初始目的并不是让其他线程停下，而是找到一个稳定的执行状态。这个执行状态下，Java虚拟机的堆栈不会发生变化。 这么一来，垃圾回收器便能够“安全”地执行可达性分析。只要不离开这个安全点，Java虚拟机便能够在垃圾回收的同时，继续运行这段本地代码。

安全点的选定既不能太少以至于让收集器等待时间过长，也不能太过频繁以至于过分增大运行时的内存负荷。

不同虚拟机对于自己 SafePoint 的实现不一定一样。

. 解释器

    每一段字节码的边界都可以作为一个 SafePoint，因为对于解释器来说找到完整的执行状态实在是一件非常容易的事。

. JIT

    对于来说则是以每个方法临返回前，以及所有的非 counted loop（可数循环） 循环回跳之前，放置一个safe point。并且在每个 SafePoint 生成一些“调试符号信息”，方便VM找到需要的运行状态。
